<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>澳洲打工度假資產管理</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  </head>
  <body>
    <div class="app-container">
      <header><h1>🦘 澳洲打工度假管理</h1></header>

      <main id="main-content">
        <section class="card shadow primary-card">
          <h2><i class="fas fa-coins"></i> 總資產估算 (現金 + 股票)</h2>
          <div class="asset-evaluation">
            <div class="eval-grid">
              <div class="eval-item"><small>換算 AUD</small><div id="eval-aud" class="main-value">$ 0.00</div></div>
              <div class="eval-item"><small>換算 TWD</small><div id="eval-twd" class="main-value">$ 0</div></div>
              <div class="eval-item"><small>換算 USD</small><div id="eval-usd" class="main-value">$ 0.00</div></div>
            </div>
          </div>
          <div class="exchange-rate-info" id="exchange-info"></div>
          <div class="currency-details">
            <div class="detail-title">目前手邊現鈔</div>
            <div class="currency-list">
              <div class="currency-row"><span class="label">AUD</span><span class="value" id="total-aud">$ 0.00</span></div>
              <div class="currency-row"><span class="label">TWD</span><span class="value" id="total-twd">$ 0</span></div>
              <div class="currency-row"><span class="label">USD</span><span class="value" id="total-usd">$ 0.00</span></div>
            </div>
          </div>
        </section>

        <section class="card shadow investment-summary">
          <div class="card-header-flex">
            <h2><i class="fas fa-chart-line"></i> 投資持倉摘要</h2>
            <button class="mini-btn" onclick="toggleStockModal()">詳細資料</button>
          </div>
          <div class="invest-grid">
            <div class="invest-box"><small>澳股投入</small><span id="invest-aud">0.00</span></div>
            <div class="invest-box"><small>台股投入</small><span id="invest-twd">0</span></div>
            <div class="invest-box"><small>美股投入</small><span id="invest-usd">0.00</span></div>
          </div>
        </section>

        <section class="card shadow">
          <h2><i class="fas fa-calendar-check"></i> 簽證天數進度</h2>
          <div class="progress-container">
            <div class="progress-row">
              <div class="progress-info"><span>二簽 (88天)</span><b id="days-2nd-text">0 / 88</b></div>
              <div class="progress-bar"><div class="progress-fill" id="progress-2nd"></div></div>
            </div>
            <div class="progress-row">
              <div class="progress-info"><span>三簽 (179天)</span><b id="days-3rd-text">0 / 179</b></div>
              <div class="progress-bar"><div class="progress-fill" id="progress-3rd"></div></div>
            </div>
          </div>
          <div class="work-action-group">
            <button class="work-btn-large" onclick="addWorkDay()">不想上班但沒錢...</button>
            <div class="work-btn-sub">
              <button onclick="undoWorkDay()">按錯ㄌ</button>
              <button onclick="showWorkLogs()">紀錄</button>
              <button onclick="exportCSV()" class="btn-csv"><i class="fas fa-file-csv"></i></button>
            </div>
          </div>
        </section>

        <section class="card shadow">
          <h2><i class="fas fa-exchange-alt"></i> 資產幣值轉換</h2>
          <div class="exchange-form">
            <div class="exchange-input-row">
              <select id="ex-from" class="styled-select" onchange="updatePreview()">
                <option value="AUD">AUD</option><option value="TWD">TWD</option><option value="USD">USD</option>
              </select>
              <i class="fas fa-chevron-right"></i>
              <select id="ex-to" class="styled-select" onchange="updatePreview()">
                <option value="TWD">TWD</option><option value="AUD">AUD</option><option value="USD">USD</option>
              </select>
            </div>
            <div class="exchange-input-row mt-10">
              <input type="number" id="ex-amount" placeholder="換出金額" oninput="updatePreview()" style="margin-bottom: 0; flex: 2;">
              <button class="btn-primary-small no-wrap" onclick="executeExchange()" style="margin-top: 0; flex: 1;">換匯</button>
            </div>
            <div id="ex-preview" style="font-size: 0.75rem; color: #666; margin-top: 8px; min-height: 1.2em;"></div>
          </div>
        </section>

        <section class="card shadow">
          <h2><i class="fas fa-plus-circle"></i> 新增股票投資</h2>
          <div class="input-form">
            <div class="type-switcher" id="stock-currency-container">
              <button class="type-btn active" data-curr="AUD" onclick="setStockCurr('AUD')">澳股AUD</button>
              <button class="type-btn" data-curr="TWD" onclick="setStockCurr('TWD')">台股TWD</button>
              <button class="type-btn" data-curr="USD" onclick="setStockCurr('USD')">美股USD</button>
            </div>
            <input type="hidden" id="stock-curr" value="AUD" />
            <div class="input-flex mt-10">
              <input type="text" id="stock-name" placeholder="標的名稱" style="flex: 2;">
              <input type="number" id="stock-shares" placeholder="股數" style="flex: 1;">
            </div>
            <input type="number" id="stock-cost" placeholder="投入總金額 (含手續費)">
            <button class="btn-primary" onclick="addInvestment()" style="background-color: #2c3e50;">記錄投資</button>
          </div>
        </section>

        <section class="card shadow">
          <h2><i class="fas fa-edit"></i> 新增收支紀錄</h2>
          <div class="input-form">
            <div class="type-switcher" id="type-container">
              <button class="type-btn" data-type="expense" onclick="setType('expense')">支出</button>
              <button class="type-btn active" data-type="income" onclick="setType('income')">收入</button>
            </div>
            <input type="hidden" id="trans-type" value="income" />
            <div class="input-flex mt-10">
              <input type="text" id="trans-desc" placeholder="項目" style="flex: 2;">
              <input type="number" id="trans-amount" placeholder="金額" style="flex: 1;">
            </div>
            <div class="type-switcher" id="currency-container">
              <button class="type-btn active" data-currency="AUD" onclick="setCurrency('AUD')">AUD</button>
              <button class="type-btn" data-currency="TWD" onclick="setCurrency('TWD')">TWD</button>
              <button class="type-btn" data-currency="USD" onclick="setCurrency('USD')">USD</button>
            </div>
            <input type="hidden" id="trans-currency" value="AUD" />
            <button class="btn-primary" onclick="addTransaction()">確認送出</button>
          </div>
          <button class="btn-reset" onclick="resetAssets()">重置所有資料</button>
        </section>

        <section class="card shadow">
          <h2><i class="fas fa-history"></i> 最近紀錄</h2>
          <ul id="transaction-list" class="list-unstyled"></ul>
        </section>
      </main>

      <div id="stock-modal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h3>持倉細節</h3>
            <span class="close" onclick="toggleStockModal()">&times;</span>
          </div>
          <div id="stock-detail-list"></div>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
